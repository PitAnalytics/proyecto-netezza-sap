---------------------------------------------------------------------------------
-- * POBLADO DE TABLAS DE GRUPOS DE CUENTAS -------------------------------------
-- * LOS INDICES SON PURAMENTE ORDINALES Y NO SON LLAVES PRIMARIAS --------------
-- * LOS ID DE LA TABLA SUPERIOR SIRVEN PARA ORGANIZAR LA TABLA INFERIOR --------
-- * EL ID SUPERIOR SIRVE COMO LLAVE FORANEA(SIN ASOCIAR) PARA UNIR LAS TABLAS --
---------------------------------------------------------------------------------

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 1 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_1(INDICE,NODO,SUPERCONCEPTO)
SELECT 1,'51200000','RESULTADO NETO' UNION ALL
SELECT 2,'51250000','PARTICIPACIÓN NO CONSOLIDADA' UNION ALL
SELECT 3,'51300000','RESULTADO NETO INCLUIDA PARTICIPACION DE LA CONTROLADORA';

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 2 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_2(INDICE,NODO_GRUPO_1,NODO,SUPERCONCEPTO)
SELECT 1,'51200000','51150000','OPERACIONES DESCONTINUADAS' UNION ALL
SELECT 2,'51200000','51100000','RESULTADO ANTES DE OPERACIONES DISCONTINUADAS';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_2
ORGANIZE ON(NODO_GRUPO_1);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 3 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_3(INDICE,NODO_GRUPO_2,NODO,SUPERCONCEPTO)
SELECT 1,'51100000','51000000','PARTICIPACIÓN EN EL RESULTADO DE SUBSIDIARIAS NO CONSOLIDADA' UNION ALL
SELECT 2,'51100000','50950000','RESULTADO ANTES DE PARTICIPACION EN SUBSIDIARIAS NO CONSOLIDADA';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_3
ORGANIZE ON(NODO_GRUPO_2);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 4 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_4(INDICE,NODO_GRUPO_3,NODO,SUPERCONCEPTO)
SELECT 1,'50950000','50900000','IMPUESTOS A LA UTILIDAD DIFERIDOS' UNION ALL
SELECT 2,'50950000','50850000','IMPUESTOS A LA UTILIDAD CAUSADOS' UNION ALL
SELECT 3,'50950000','50800000','RESULTADO ANTES DE IMPUESTOS A LA UTILIDAD';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_4
ORGANIZE ON(NODO_GRUPO_3);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 5 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_5(INDICE,NODO_GRUPO_4,NODO,SUPERCONCEPTO)
SELECT 1,'50800000','50650000','RESULTADO DE LA OPERACION' UNION ALL
SELECT 2,'50800000','50700000','OTROS PRODUCTOS' UNION ALL
SELECT 3,'50800000','50750000','OTROS GASTOS';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_5
ORGANIZE ON(NODO_GRUPO_4);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 6 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_6(INDICE,NODO_GRUPO_5,NODO,SUPERCONCEPTO)
SELECT 1,'50650000','50550000','TOTAL DE INGRESOS SELECT EGRESOS) DE LA OPERACION' UNION ALL
SELECT 2,'50650000','50600000','GASTOS DE ADMINISTRACION Y PROMOCION';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_6
ORGANIZE ON(NODO_GRUPO_5);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 7 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_7(INDICE,NODO_GRUPO_6,NODO,SUPERCONCEPTO)
SELECT 1,'50550000','50300000','MARGEN FINANCIERO AJUSTADO POR RIESGO CREDITICIO' UNION ALL
SELECT 2,'50550000','50350000','COMISIONES Y TARIFAS COBRADAS' UNION ALL
SELECT 3,'50550000','50400000','COMISIONES Y TARIFAS PAGADAS' UNION ALL
SELECT 4,'50550000','50450000','RESULTADO POR INTERMEDIACION' UNION ALL
SELECT 5,'50550000','50500000','OTROS INGRESOS SELECT EGRESOS DE LA OPERACION)';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_7
ORGANIZE ON(NODO_GRUPO_6);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 8 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_8(INDICE,NODO_GRUPO_7,NODO,SUPERCONCEPTO)
SELECT 1,'50300000','50250000','ESTIMACIÓN PREVENTIVA PARA RIESGOS CREDITICIOS' UNION ALL
SELECT 2,'50300000','50200000','MARGEN FINANCIERO';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_8
ORGANIZE ON(NODO_GRUPO_7);

----------------------------------------------
------------ POBLAMOS TABLA GRUPOS 9 ---------
----------------------------------------------
INSERT INTO ESQUEMA_GRUPOS_9(INDICE,NODO_GRUPO_8,NODO,SUPERCONCEPTO)
SELECT 1,'50200000','50100000','GASTOS POR INTERESES' UNION ALL
SELECT 2,'50200000','50050000','INGRESOS POR INTERESES';
--- ORGANIZAMOS EN BASE A LOS IDS PADRES ----
ALTER TABLE GRUPOS_9
ORGANIZE ON(NODO_GRUPO_8);
